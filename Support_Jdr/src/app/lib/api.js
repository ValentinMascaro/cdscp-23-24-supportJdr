var api;(()=>{"use strict";var e={d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{WhiteboardTeam:()=>s});class a extends Error{constructor(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];super(...r),Error.captureStackTrace&&Error.captureStackTrace(this,a),this.name="WhiteboardError",this.type=e,this.date=new Date}}const r=class{constructor(){this.subscribers=new Map}publish(e,t){var a=this.subscribers.get(e);a&&a.forEach((e=>{e(t)}))}subscribe(e,t){var a=this.subscribers.get(e);a?a.push(t):this.subscribers.set(e,[t])}};class s{constructor(e,t){var s,n;t=Object.assign(this.getDefaultOptions(),t||{}),this.eventManager=new r;var o,i=void 0;if("string"==typeof e?i=document.querySelector(e):(o=e,("object"==typeof HTMLElement?o instanceof HTMLElement:o&&"object"==typeof o&&null!==o&&1===o.nodeType&&"string"==typeof o.nodeName)&&(i=e)),null!=i){if(null==t.clientId)return i.innerText="clientId is required",void console.error("Whiteboard Team: clientId is required");if(null==t.boardCode&&(t.boardCode=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}("wtBoard")),null==t.boardCode)return i.innerText="boardCode is required",void console.error("Whiteboard Team: boardCode is required");if(t.onError&&console.log("onError callback is deprecated: use addListener('error', callback) or waitUntilReady().catch()"),t.onReady&&console.log("onReady callback is deprecated: use addListener('ready', callback) or waitUntilReady().then()"),!t.hasOwnProperty("participant")||t.participant)if(!t.participant.hasOwnProperty("role")||t.participant.role)if(!t.participant.role||["facilitator","editor","commenter","viewer"].includes(t.participant.role.toLowerCase()))if(!t.participant.hasOwnProperty("name")||t.participant.name){this.readyPromise=new Promise(((e,t)=>{this.eventManager.subscribe("ready",(t=>e(t))),this.eventManager.subscribe("error",(e=>t(e)))}));0;var d=null===(s=t)||void 0===s||null===(n=s.participant)||void 0===n?void 0:n.id;d||(d=localStorage.getItem("uid4api")),d||(d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t,a=new Uint32Array(1);return t=(a=window.crypto.getRandomValues(a))[0]%16,("x"===e?t:3&t|8).toString(16)})),localStorage.setItem("uid4api",d));var l={board:t.board||{},participant:t.participant||{},features:t.features||{}},c=btoa(JSON.stringify(l)),p=document.createElement("iframe");p.id="whiteboard_team",p.src="".concat("https://www.whiteboard.team","/app/board/").concat(t.boardCode,"?clientid=").concat(t.clientId,"&uid=").concat(d,"&data=").concat(c),p.width="100%",p.height="100%",p.seamless=!0,p.style.border="none",t.features.activeOnClick&&(p.style.pointerEvents="none"),p.addEventListener("fullscreenchange",(e=>{document.fullscreenElement?this.app.postMessage({cmd:"fullscreen",data:{mode:!0}},"*"):this.app.postMessage({cmd:"fullscreen",data:{mode:!1}},"*")})),t.onReady&&this.onReady(t.onReady),t.onError&&this.onError(t.onError),this.receiveMessage=e=>{switch(e.data.cmd){case"ready":this.eventManager.publish("onReady",{uid:e.data.data.uid}),this.eventManager.publish("ready",{uid:e.data.data.uid}),this.keys=e.data.data.keys;break;case"onEvent":this.eventManager.publish(e.data.data.name,e.data.data.params);break;case"error":if("Fatal"==e.data.type){var t=document.createElement("span");t.innerText=e.data.message,i.appendChild(t),p.remove()}var r=new a(e.data.type,e.data.message);this.eventManager.publish("onError",r),this.eventManager.publish("error",r),console.error(e.data.message);break;case"fullscreen":this.fullscreen(e.data.data.mode);break;case"reload":location.reload(!0)}},window.addEventListener("message",this.receiveMessage,!1),t.features.globalShorcutKeys&&(this.keyUpHandler=e=>this.keyHandler(e,"onKeyUp"),this.keyDownHandler=e=>this.keyHandler(e,"onKeyDown"),window.addEventListener("keyup",this.keyUpHandler),window.addEventListener("keydown",this.keyDownHandler)),t.features.activeOnClick&&(this.enablePointerEvents=()=>p.style.pointerEvents="auto",this.disablePointerEvents=()=>p.style.pointerEvents="none",i.addEventListener("click",this.enablePointerEvents),i.addEventListener("mouseleave",this.disablePointerEvents)),i.append(p),this.app=p.contentWindow,this.frame=p,this.parent=i}else console.error("Whiteboard Team: invalid value for participant.name");else console.error("Whiteboard Team: invalid value for participant.role");else console.error("Whiteboard Team: invalid value for participant.role");else console.error("Whiteboard Team: invalid value for participant")}else console.error("Whiteboard Team: container not found:",e)}keyHandler(e,t){e.target.isContentEditable||"textarea"!==e.target.tagName.toLowerCase()&&("input"===e.target.tagName.toLowerCase()&&"tools"!=e.target.name||e.target.getAttribute("contenteditable")||this.keys.find((a=>a.key===e.code&&a.type===("onKeyUp"===t?"up":"down")&&(e.shiftKey===a.isShift&&e.altKey===a.isAlt&&e.ctrlKey===a.isCtrl||a.isAnyModifier)))&&(e.preventDefault(),e.stopPropagation(),this.app.postMessage({cmd:t,data:{code:e.code,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.ctrlKey}},"*")))}addListener(e,t){this.eventManager.subscribe(e,t)}waitUntilReady(){return this.readyPromise}onReady(e){console.log("onReady deprecated: use addListener('ready', callback) or waitUntilReady().then()"),this.eventManager.subscribe("ready",e)}onError(e){console.log("onError deprecated: use addListener('error', callback) or waitUntilReady().catch()"),this.eventManager.subscribe("error",e)}get version(){return"1.50.1"}notify(e){this.app.postMessage({cmd:"notify",data:{message:e}},"*")}zoomIn(){this.app.postMessage({cmd:"zoomIn"},"*")}zoomOut(){this.app.postMessage({cmd:"zoomOut"},"*")}resetZoom(){this.app.postMessage({cmd:"resetZoom"},"*")}fitToScreen(){this.app.postMessage({cmd:"fitToScreen"},"*")}undo(){this.app.postMessage({cmd:"undo"},"*")}redo(){this.app.postMessage({cmd:"redo"},"*")}debug(){this.app.postMessage({cmd:"debug"},"*")}fullscreen(e){void 0===e&&(e=!0),e?this.frame.requestFullscreen?(this.frame.requestFullscreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!0}},"*")):this.frame.mozRequestFullScreen?(this.frame.mozRequestFullScreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!0}},"*")):this.frame.webkitRequestFullscreen?(this.frame.webkitRequestFullscreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!0}},"*")):this.frame.msRequestFullscreen&&(this.frame.msRequestFullscreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!0}},"*")):document.exitFullscreen?(document.exitFullscreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!1}},"*")):document.mozCancelFullScreen?(document.mozCancelFullScreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!1}},"*")):document.webkitExitFullscreen?(document.webkitExitFullscreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!1}},"*")):document.msExitFullscreen&&(document.msExitFullscreen(),this.app.postMessage({cmd:"fullscreen",data:{mode:!1}},"*"))}removeCommand(e){this.app.postMessage({cmd:"removeCommand",data:e},"*")}drawCircle(e,t,a,r,s,n){return new Promise(((o,i)=>{var d=new MessageChannel;d.port1.onmessage=e=>o(e.data),this.app.postMessage({cmd:"drawCircle",data:{x:e,y:t,r:a,stroke:r,lineWidth:s,fill:n}},"*",[d.port2])}))}drawRectangle(e,t,a,r,s,n,o){return new Promise(((i,d)=>{var l=new MessageChannel;l.port1.onmessage=e=>i(e.data),this.app.postMessage({cmd:"drawRectangle",data:{x:e,y:t,w:a,h:r,stroke:s,lineWidth:n,fill:o}},"*",[l.port2])}))}drawLine(e,t,a,r){return new Promise(((s,n)=>{var o=new MessageChannel;o.port1.onmessage=e=>s(e.data),this.app.postMessage({cmd:"drawLine",data:{points:e,color:t,lineWidth:a,type:r}},"*",[o.port2])}))}drawPen(e,t,a){return new Promise(((r,s)=>{var n=new MessageChannel;n.port1.onmessage=e=>r(e.data),this.app.postMessage({cmd:"drawPen",data:{points:e,color:t,lineWidth:a}},"*",[n.port2])}))}drawText(e,t,a,r,s,n){return new Promise(((o,i)=>{var d=new MessageChannel;d.port1.onmessage=e=>o(e.data),this.app.postMessage({cmd:"drawText",data:{x:e,y:t,text:a,color:r,font:s,size:n}},"*",[d.port2])}))}drawStickyNote(e,t,a,r,s,n,o){return new Promise(((i,d)=>{var l=new MessageChannel;l.port1.onmessage=e=>i(e.data),this.app.postMessage({cmd:"drawStickyNote",data:{x:e,y:t,w:a,h:r,text:s,color:n,size:o}},"*",[l.port2])}))}drawFrame(e,t,a,r,s,n){return new Promise(((o,i)=>{var d=new MessageChannel;d.port1.onmessage=e=>o(e.data),this.app.postMessage({cmd:"drawFrame",data:{x:e,y:t,w:a,h:r,title:s,color:n}},"*",[d.port2])}))}drawImage(e,t,a){return new Promise(((r,s)=>{var n=new MessageChannel;n.port1.onmessage=e=>{e.data.success?r(e.data.shape):s(new Error("failed to upload image"))},this.app.postMessage({cmd:"drawImage",data:{url:e,x:t,y:a}},"*",[n.port2])}))}getImage(e){var t=this;return new Promise(((a,r)=>{var s=new MessageChannel;s.port1.onmessage=e=>{a(e.data.image)},t.app.postMessage({cmd:"getImage",data:{background:e}},"*",[s.port2])}))}getCurrentUser(){var e=this;return new Promise(((t,a)=>{var r=new MessageChannel;r.port1.onmessage=e=>{t(e.data)},e.app.postMessage({cmd:"getCurrentUser"},"*",[r.port2])}))}get members(){var e=this;return{grabAttention(){e.app.postMessage({cmd:"members.grabAttention"},"*")}}}get viewport(){var e=this;return{zoomTo(t){e.app.postMessage({cmd:"viewport.zoomTo",data:{id:t.id}},"*")}}}get board(){var e=this;return{get:()=>new Promise(((t,a)=>{var r=new MessageChannel;r.port1.onmessage=e=>{t(e.data)},e.app.postMessage({cmd:"board.get"},"*",[r.port2])})),clear(){e.app.postMessage({cmd:"clear"},"*")}}}destroy(){window.removeEventListener("keyup",this.keyUpHandler),window.removeEventListener("keydown",this.keyDownHandler),window.removeEventListener("message",this.receiveMessage,!1),this.parent.removeEventListener("click",this.enablePointerEvents),this.parent.removeEventListener("mouseleave",this.disablePointerEvents),this.frame.remove()}getDefaultOptions(){return{clientId:null,boardCode:null,participant:{},board:{},features:{}}}}api=t})();


// export default api;
export default api;